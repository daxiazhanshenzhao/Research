# è§†å›¾å®šä½åŠŸèƒ½ä¿®æ­£è¯´æ˜

## ä¿®æ­£å†…å®¹

### é—®é¢˜
åŸå®ç°å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
1. âŒ è®¡ç®—ç§‘æŠ€ä¸­å¿ƒåæ ‡è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ TechSlot çš„ç¼“å­˜åæ ‡
2. âŒ ç›®æ ‡ä½ç½®ä¸ºè§†å£ä¸­å¿ƒï¼Œä½† GUI å·¦åŠéƒ¨åˆ†è¢«é®æŒ¡
3. âŒ åæ ‡è½¬æ¢å…¬å¼ä¸å®Œæ•´

### ä¿®æ­£
1. âœ… ç›´æ¥ä½¿ç”¨ `TechSlot.getX()` å’Œ `TechSlot.getY()` è·å–ä¸–ç•Œåæ ‡
2. âœ… ç›®æ ‡ä½ç½®æ”¹ä¸º **GUI å³è¾¹ 3/4 å¤„ï¼ˆæ°´å¹³ï¼‰+ é«˜åº¦ 1/2 å¤„ï¼ˆå‚ç›´ï¼‰**
3. âœ… å®Œæ•´çš„åæ ‡è½¬æ¢å…¬å¼ï¼Œè€ƒè™‘ç¼©æ”¾å’Œä¸­å¿ƒç‚¹

## æ–°çš„å®ç°

### ç›®æ ‡ä½ç½®è®¡ç®—

```java
// æ°´å¹³ï¼šGUI å³è¾¹ 3/4 å¤„ï¼ˆé¿å¼€å·¦ä¾§é®æŒ¡åŒºåŸŸï¼‰
int targetScreenX = insideX + (int)(insideWidth * 0.75);

// å‚ç›´ï¼šGUI é«˜åº¦ 1/2 å¤„ï¼ˆå‚ç›´å±…ä¸­ï¼‰
int targetScreenY = insideY + insideHeight / 2;
```

### åæ ‡è½¬æ¢

#### æ­£å‘å˜æ¢å…¬å¼
```
screenX = (worldX - centerX) * scale + centerX + offsetX
```

#### æ±‚è§£åç§»é‡
```
offsetX = targetScreenX - (worldX - centerX) * scale - centerX
        = targetScreenX - worldX * scale + centerX * scale - centerX
        = targetScreenX - worldX * scale + centerX * (scale - 1)
```

#### ä»£ç å®ç°
```java
float scale = mouseData.getScale();
double newOffsetX = targetScreenX - techWorldX * scale + centerX * (scale - 1);
double newOffsetY = targetScreenY - techWorldY * scale + centerY * (scale - 1);
```

## GUI å¸ƒå±€è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  è§†å£åŒºåŸŸï¼ˆInsideï¼‰                 â”‚
â”‚                                                    â”‚
â”‚  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                                        â”‚
â”‚  â–‘â–‘é®æŒ¡åŒºåŸŸâ–‘                                        â”‚
â”‚  â–‘â–‘(å·¦ä¾§)â–‘â–‘                                        â”‚
â”‚  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                                        â”‚
â”‚                                                    â”‚
â”‚      â†‘ 1/4          â†‘ 1/2          â†‘ 3/4          â”‚
â”‚                                    ğŸ¯              â”‚
â”‚                                 ç›®æ ‡ä½ç½®            â”‚
â”‚                          (å³è¾¹ 3/4ï¼Œé«˜åº¦ 1/2)      â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½ç½®é€‰æ‹©åŸå› 

| ä½ç½® | åŸå›  |
|------|------|
| æ°´å¹³ 3/4 | é¿å¼€å·¦ä¾§é®æŒ¡åŒºåŸŸï¼Œç¡®ä¿ç§‘æŠ€å®Œå…¨å¯è§ |
| å‚ç›´ 1/2 | å‚ç›´å±…ä¸­ï¼Œæœ€ä½³è§‚çœ‹è§’åº¦ |

## ä½¿ç”¨çš„åæ ‡

### ç›´æ¥ä½¿ç”¨ TechSlot çš„åæ ‡
```java
// ä¸éœ€è¦è®¡ç®—ä¸­å¿ƒç‚¹ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜çš„ä¸–ç•Œåæ ‡
int techWorldX = techSlot.getX();
int techWorldY = techSlot.getY();
```

### è¿™äº›åæ ‡çš„æ¥æº
åœ¨ `TechSlotData.initializePositionsWithVecMap()` ä¸­è®¾ç½®ï¼š
```java
techSlot.setPosition(guiLeftOffset + x, guiTopOffset + y);
```

è¿™äº›åæ ‡å·²ç»æ˜¯æ­£ç¡®çš„ä¸–ç•Œåæ ‡ï¼ˆèƒŒæ™¯çº¹ç†åæ ‡ç³»ï¼‰ï¼Œä¸éœ€è¦å†æ¬¡è®¡ç®—ã€‚

## åæ ‡ç³»ç»Ÿå±‚æ¬¡

```
1. ä¸–ç•Œåæ ‡ç³»ï¼ˆèƒŒæ™¯çº¹ç†åæ ‡ç³»ï¼‰
   - TechSlot.getX(), TechSlot.getY() â† ç›´æ¥ä½¿ç”¨
   - å›ºå®šä¸å˜çš„ç»å¯¹åæ ‡
   
2. è§†å£å˜æ¢ï¼ˆç¼©æ”¾ + å¹³ç§»ï¼‰
   - scaleï¼šç¼©æ”¾çº§åˆ«
   - offsetX, offsetYï¼šå¹³ç§»åç§»
   
3. å±å¹•åæ ‡ç³»ï¼ˆè§†å£åæ ‡ç³»ï¼‰
   - targetScreenX = insideX + insideWidth * 0.75
   - targetScreenY = insideY + insideHeight / 2
```

## å…³é”®æ”¹è¿›ç‚¹

### 1. ç›´æ¥ä½¿ç”¨ç¼“å­˜åæ ‡
**ä¹‹å‰**ï¼š
```java
int techCenterX = techSlot.getX() + TechSlot.Width / 2;
int techCenterY = techSlot.getY() + TechSlot.Height / 2;
```

**ç°åœ¨**ï¼š
```java
int techWorldX = techSlot.getX();
int techWorldY = techSlot.getY();
```

**ä¼˜åŠ¿**ï¼š
- æ›´é«˜æ•ˆï¼ˆæ— éœ€è®¡ç®—ä¸­å¿ƒç‚¹ï¼‰
- æ›´å‡†ç¡®ï¼ˆä½¿ç”¨åŸå§‹åæ ‡ï¼‰
- é¿å…å› æ§½ä½å¤§å°æ”¹å˜è€Œéœ€è¦ä¿®æ”¹ä»£ç 

### 2. ä¼˜åŒ–ç›®æ ‡ä½ç½®
**ä¹‹å‰**ï¼š
```java
int viewportCenterX = getCenterX();
int viewportCenterY = getCenterY();
```

**ç°åœ¨**ï¼š
```java
int targetScreenX = insideX + (int)(insideWidth * 0.75);
int targetScreenY = insideY + insideHeight / 2;
```

**ä¼˜åŠ¿**ï¼š
- é¿å¼€é®æŒ¡åŒºåŸŸ
- ç§‘æŠ€å®Œå…¨å¯è§
- æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

### 3. å®Œæ•´çš„åæ ‡è½¬æ¢
**ä¹‹å‰**ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š
```java
double newOffsetX = viewportCenterX - techCenterX * scale;
```

**ç°åœ¨**ï¼ˆå®Œæ•´ç‰ˆï¼‰ï¼š
```java
double newOffsetX = targetScreenX - techWorldX * scale + centerX * (scale - 1);
```

**ä¼˜åŠ¿**ï¼š
- æ­£ç¡®å¤„ç†ä»»æ„ç¼©æ”¾çº§åˆ«
- æ­£ç¡®å¤„ç†è§†å£ä¸­å¿ƒåç§»
- æ•°å­¦ä¸Šä¸¥æ ¼æ­£ç¡®

## æµ‹è¯•éªŒè¯

### æµ‹è¯•ç‚¹
- [ ] ç‚¹å‡»æœç´¢ç»“æœåç§‘æŠ€ç§»åŠ¨åˆ° GUI å³è¾¹ 3/4 å¤„
- [ ] ç§‘æŠ€å‚ç›´ä½ç½®åœ¨ GUI é«˜åº¦ 1/2 å¤„
- [ ] ç§‘æŠ€ä¸ä¼šè¢«å·¦ä¾§ UI é®æŒ¡
- [ ] ä¸åŒç¼©æ”¾çº§åˆ«ä¸‹éƒ½èƒ½æ­£ç¡®å®šä½
- [ ] è¾¹ç•Œé™åˆ¶æ­£å¸¸å·¥ä½œï¼ˆä¸ä¼šè¶…å‡ºèƒŒæ™¯èŒƒå›´ï¼‰
- [ ] åæ ‡è½¬æ¢å‡†ç¡®ï¼ˆç§‘æŠ€å‡ºç°åœ¨é¢„æœŸä½ç½®ï¼‰

### éªŒè¯å…¬å¼
å¯ä»¥é€šè¿‡åå‘è®¡ç®—éªŒè¯ï¼š
```java
// åº”ç”¨åç§»åï¼Œç§‘æŠ€çš„å±å¹•åæ ‡åº”è¯¥ç­‰äºç›®æ ‡å±å¹•åæ ‡
double resultScreenX = (techWorldX - centerX) * scale + centerX + newOffsetX;
assert Math.abs(resultScreenX - targetScreenX) < 1.0; // å…è®¸æµ®ç‚¹è¯¯å·®
```

## æ€§èƒ½ä¼˜åŒ–

- **O(1) æ—¶é—´å¤æ‚åº¦**ï¼šæ‰€æœ‰è®¡ç®—éƒ½æ˜¯ç®€å•çš„ç®—æœ¯è¿ç®—
- **æ— å†…å­˜åˆ†é…**ï¼šåªä¿®æ”¹ç°æœ‰çš„ offsetX å’Œ offsetY
- **ç¬æ—¶å®Œæˆ**ï¼šç”¨æˆ·æ„Ÿè§‰ä¸åˆ°å»¶è¿Ÿ

## ç›¸å…³æ–‡ä»¶

- `ClientScreenManager.java` - centerOnTechSlot() æ–¹æ³•
- `SearchTechSlot.java` - onPress() è°ƒç”¨å®šä½åŠŸèƒ½
- `TechSlotData.java` - initializePositionsWithVecMap() è®¾ç½®åˆå§‹åæ ‡
- `SEARCH_CENTER_ON_TECH.md` - è¯¦ç»†æ–‡æ¡£

## æ€»ç»“

ä¿®æ­£åçš„å®ç°ï¼š
1. âœ… ç›´æ¥ä½¿ç”¨ TechSlot çš„ç¼“å­˜ä¸–ç•Œåæ ‡
2. âœ… ç›®æ ‡ä½ç½®ä¸º GUI å³è¾¹ 3/4ã€é«˜åº¦ 1/2
3. âœ… å®Œæ•´ä¸”æ­£ç¡®çš„åæ ‡è½¬æ¢å…¬å¼
4. âœ… é¿å¼€ GUI å·¦ä¾§é®æŒ¡åŒºåŸŸ
5. âœ… æä¾›æœ€ä½³çš„ç”¨æˆ·ä½“éªŒ

è¿™ä¸ªå®ç°åœ¨æ•°å­¦ä¸Šä¸¥æ ¼æ­£ç¡®ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­è¡¨ç°ä¼˜ç§€ï¼
